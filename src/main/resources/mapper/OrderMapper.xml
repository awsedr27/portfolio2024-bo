<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.portfolioBo.order.dao.OrderDao">
    <select id="selectOrdersList" parameterType="com.portfolioBo.order.dto.OrderDto$OrdersListQuery" resultType="com.portfolioBo.order.dto.OrderDto">
        SELECT 
			order_id,
			user_id,
			total_price,
			status,
			create_date,
			modify_date
        FROM 
            orders
        WHERE
            1=1
            <if test="orderId != null">
                AND product_id = #{orderId}
            </if>
            <if test="userId != null and userId != ''">
                AND user_id LIKE CONCAT('%', #{userId}, '%')
            </if>
            <if test="status != null and status != ''">
                AND status = #{status}
            </if>
            ORDER BY create_date DESC
			LIMIT #{paging.startRecordIndex}, #{paging.pageSize}
    </select>
    <select id="selectOrdersListCnt" parameterType="com.portfolioBo.order.dto.OrderDto$OrdersListQuery" resultType="Integer">
        SELECT 
      		COUNT(*)
        FROM 
            orders
        WHERE
            1=1
            <if test="orderId != null">
                AND product_id = #{orderId}
            </if>
            <if test="userId != null and userId != ''">
                AND user_id LIKE CONCAT('%', #{userId}, '%')
            </if>
            <if test="status != null and status != ''">
                AND status = #{status}
            </if>
    </select>
    
</mapper>